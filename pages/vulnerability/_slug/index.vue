<template>
  <div class="vulnerability flex-column" >



    <nuxt-link tag="div" to="/" class="back-button"> <fa class="icon-small" :icon="['fas', 'chevron-left']" /> Back to list </nuxt-link>



    <div class="top flex-row" v-if="vulnerability">
      <h1>{{vulnerability.title}}</h1>
      <img :src="vulnerability.img_url" alt="Vulnerability thumbnail">
    </div>



    <div class="table-info flex-column" v-if="vulnerability">


      <h2>Factors</h2>


      <div class="table flex-column">

        <div class="table-heading grid-9">
          <div class="heading-item flex-column">CWEs Mapped	</div>
          <div class="heading-item flex-column">Max Incidence Rate</div>
          <div class="heading-item flex-column">Avg Incidence Rate</div>
          <div class="heading-item flex-column">Avg Weighted Exploit	</div>
          <div class="heading-item flex-column">Avg Weighted Impact	</div>
          <div class="heading-item flex-column">Max Coverage</div>
          <div class="heading-item flex-column">Avg Coverage</div>
          <div class="heading-item flex-column">Total Occurrences	</div>
          <div class="heading-item flex-column">Total CVEs</div>
        </div>

        <div class="table-data grid-9">
          <div class="data-item flex-column">{{vulnerability.cwes_mapped}}</div>
          <div class="data-item flex-column">{{vulnerability.max_incidence_rate}}</div>
          <div class="data-item flex-column">{{vulnerability.avg_incidence_rate}}</div>
          <div class="data-item flex-column">{{vulnerability.avg_weighted_exploit}}</div>
          <div class="data-item flex-column">{{vulnerability.avg_weighted_impact}}</div>
          <div class="data-item flex-column">{{vulnerability.max_coverage}}</div>
          <div class="data-item flex-column">{{vulnerability.avg_coverage}}</div>
          <div class="data-item flex-column">{{vulnerability.total_occurrences}}</div>
          <div class="data-item flex-column">{{vulnerability.total_cves}}</div>
        </div>

      </div>


    </div>



    <div class="text-info" v-html="$md.render(markdown_text)" v-if="vulnerability"> </div>



  </div>
</template>

<script>

export default {

  data(){
    return{
      vulnerability: {},
      markdown_text: ""
    }
  },

  mounted(){
    this.vulnerability = this.$store.getters['vulnerabilities/getBySlug'] (this.$route.params.slug)

    if(this.vulnerability)
      this.markdown_text = this.vulnerability.text
  }

}
</script>

<style lang="scss" scoped>
  .vulnerability{
    position: relative;
    background-color: $light-2;
    color: $dark-2;
    width: 100%;
    padding: 3rem;
    box-sizing: border-box;

    .back-button{
      position: absolute;
      top: 3rem;
      left: 3rem;
      color: $dark-4;
      font-size: 1.1rem;
      font-weight: 500;
      cursor: pointer;
      transition: 0.3s ease-in-out;

      &:hover{
        transform: translateX(1rem);
      }
    }

    .top{
      justify-content: space-between;
      width: 100%;

      h1{
        color: $blue;
      }

      img{
        height: 15rem;
      }
    }

    .table-info{
      align-items: flex-start;
      width: 100%;

      h2{
        color: $blue;
      }

      .table{
        width: 100%;
        margin-top: 1rem;

        .table-heading{
          background-color: $light-3;
          width: 100%;
          padding: 1rem 0;

          .heading-item{
            text-align: center;
            color: $dark-2;
            font-size: 1.1rem;
            font-weight: 600;
          }
        }

        .table-data{
          background-color: $light-1;
          width: 100%;
          padding: 1rem 0;

          .data-item{
            text-align: center;
            color: $dark-3;
            font-size: 1rem;
            font-weight: 500;
          }
        }
      }
    }

    .text-info{
      width: 100%;

      &::v-deep h2{
        color: $blue;
        margin-top: 1.5rem;
      }

      &::v-deep p{
        font-size: 1.2rem;
        font-weight: 500;
        margin-top: 0.4rem;
      }

      &::v-deep ul{
        list-style: disc;
        margin-top: 0.5rem;
        margin-left: 2rem;

        li{
          font-size: 1.2rem;
          font-weight: 500;
        }
      }

      &::v-deep strong{
        color: $dark-1;
        font-weight: bolder;
      }

      &::v-deep pre{
        background-color: $light-3;
        font-size: 1.2rem;
        width: fit-content;
        margin: 1rem 0;
        padding: 1rem 2rem;
        box-sizing: border-box;
        border-radius: 3px;

        code{
          font-weight: 500;
        }
      }

      &::v-deep a{
        font-size: 1.2rem;
        font-weight: 500;
        color: $blue;
        transition: 0.3s ease-in-out;

        &:hover{
          margin-left: 0.5rem;
        }
      }
    }
  }



  //********RESPONSIVE*********/
  .laptopL{

    .top{

      img{
        height: 12rem;
      }
    }

    .table-info{

      .table{

        .table-heading{
          padding: 0.7rem 0;

          .heading-item{
            font-size: 1rem;
          }
        }

        .table-data{
          padding: 0.7rem 0;

          .data-item{
            font-size: 0.9rem;
          }
        }
      }
    }

    .text-info{

      &::v-deep h2{
        margin-top: 1.2rem;
      }

      &::v-deep p{
        font-size: 1.1rem;
        margin-top: 0.3rem;
      }

      &::v-deep ul{
        margin-top: 0.4rem;
        margin-left: 1.5rem;

        li{
          font-size: 1.1rem;
        }
      }

      &::v-deep pre{
        padding: 0.7rem 1.5rem;
        font-size: 1.1rem;
      }

      &::v-deep a{
        font-size: 1.1rem;
      }
    }
  }

  .laptop{
    padding: 2rem;

    .back-button{
      top: 2rem;
      left: 2rem;
      font-size: 1rem;
    }

    .top{

      img{
        height: 10rem;
      }
    }

    .table-info{

      .table{

        .table-heading{
          padding: 0.5rem 0;

          .heading-item{
            font-size: 0.9rem;
          }
        }

        .table-data{
          padding: 0.5rem 0;

          .data-item{
            font-size: 0.8rem;
          }
        }
      }
    }

    .text-info{

      &::v-deep h2{
        margin-top: 1.1rem;
      }

      &::v-deep p{
        font-size: 1rem;
        margin-top: 0.3rem;
      }

      &::v-deep ul{
        margin-top: 0.4rem;
        margin-left: 1.5rem;

        li{
          font-size: 1rem;
        }
      }

      &::v-deep pre{
        padding: 0.7rem 1.2rem;
        font-size: 1rem;
      }

      &::v-deep a{
        font-size: 1rem;
      }
    }
  }

  .tablet{
    padding: 1.5rem;

    .back-button{
      top: 1.5rem;
      left: 1.5rem;
      font-size: 0.9rem;

      &:hover{
        transform: translateX(0.5rem);
      }
    }

    .top{

      img{
        height: 8rem;
      }
    }

    .table-info{

      .table{
        flex-direction: row;

        .table-heading{
          grid-template-columns: 1fr;
          height: 100%;
          padding: 0.3rem 0;

          .heading-item{
            font-size: 0.8rem;
          }
        }

        .table-data{
          grid-template-columns: 1fr;
          height: 100%;
          padding: 0.3rem 0;

          .data-item{
            font-size: 0.8rem;
          }
        }
      }
    }

    .text-info{

      &::v-deep h2{
        margin-top: 1rem;
      }

      &::v-deep p{
        font-size: 0.95rem;
        margin-top: 0.3rem;
      }

      &::v-deep ul{
        margin-top: 0.3rem;
        margin-left: 1.3rem;

        li{
          font-size: 0.95rem;
        }
      }

      &::v-deep pre{
        padding: 0.5rem 1rem;
        font-size: 0.95rem;
      }

      &::v-deep a{
        font-size: 0.95rem;
      }
    }
  }

  .phone{
    padding: 1rem;

    .back-button{
      top: 1rem;
      left: 1rem;
      font-size: 0.9rem;

      &:hover{
        transform: translateX(0.5rem);
      }
    }

    .top{
      margin-top: 0.5rem;

      img{
        height: 6rem;
        margin-left: 0.5rem;
      }
    }

    .table-info{

      .table{
        flex-direction: row;

        .table-heading{
          grid-template-columns: 1fr;
          height: 100%;
          padding: 0.3rem 0;

          .heading-item{
            font-size: 0.7rem;
          }
        }

        .table-data{
          grid-template-columns: 1fr;
          height: 100%;
          padding: 0.3rem 0;

          .data-item{
            font-size: 0.7rem;
          }
        }
      }
    }

    .text-info{

      &::v-deep h2{
        margin-top: 0.7rem;
      }

      &::v-deep p{
        font-size: 0.9rem;
        margin-top: 0.3rem;
      }

      &::v-deep ul{
        margin-top: 0.3rem;
        margin-left: 1.1rem;

        li{
          font-size: 0.9rem;
        }
      }

      &::v-deep pre{
        padding: 0.5rem 1rem;
        font-size: 0.75rem;
      }

      &::v-deep a{
        font-size: 0.9rem;
      }
    }
  }

  .phoneS{
    padding: 1rem;

    .back-button{
      top: 1rem;
      left: 1rem;
      font-size: 0.8rem;

      &:hover{
        transform: translateX(0.3rem);
      }
    }

    .top{
      margin-top: 0.5rem;

      img{
        height: 5rem;
        margin-left: 0.5rem;
      }
    }

    .table-info{

      .table{
        flex-direction: row;

        .table-heading{
          grid-template-columns: 1fr;
          height: 100%;
          padding: 0.25rem 0;

          .heading-item{
            font-size: 0.6rem;
          }
        }

        .table-data{
          grid-template-columns: 1fr;
          height: 100%;
          padding: 0.25rem 0;

          .data-item{
            font-size: 0.6rem;
          }
        }
      }
    }

    .text-info{

      &::v-deep h2{
        margin-top: 0.5rem;
      }

      &::v-deep p{
        font-size: 0.8rem;
        margin-top: 0.3rem;
      }

      &::v-deep ul{
        margin-top: 0.3rem;
        margin-left: 1rem;

        li{
          font-size: 0.8rem;
        }
      }

      &::v-deep pre{
        padding: 0.5rem;
        font-size: 0.5rem;
      }

      &::v-deep a{
        font-size: 0.8rem;
      }
    }
  }
</style>
